- [Create Git Repository for local Terraform Project](#Create-Git-Repository-for-local-Terraform-Project)

- [Install Terraform](#Install-Terraform)

- [Basic Terraform Structure](#Basic Terraform Structure)

  - [Configure Terraform AWS Proivder](#Configure-Terraform-AWS-Proivder) 

- [Automate AWS Infrastructure](#Automate-AWS-Infrastructure)

  - [Overview](#Overview)
 
  - [VPC and Subnet](#VPC-and-Subnet)
 
  - [Route Table And Internet Gateway](#RouteTableAndInternetGateway)
 
  - [Create new Route Table](#Create-new-Route-Table)
  
# Terraform-Exercise

## Create Git Repository for local Terraform Project

Initialize empty repo : git init

Connect to remote folder : git remote add origin <git-repo-url> . This is will point to the remote project I have create in Github

git status (check current status of git) : It tell me I have to check in all the code

`.gitignore`:

 - Ignore .terraform/* folder . Doesn't have to part of the code bcs when I do terraform init it will be downloaded on my computer locally

 - Ignore *.tfstate, *.tfstate.* bcs Terraform is a generated file that gets update everytime I do terraform apply.

 - Ignore *.tfvars the reason is Terraform variables are a way to give users of terraform a way to set Parameter for the configurations file this parameters will be different base on the Environment . Also Terraform file may acutally contain some sensitive data

Basiccally I have main.tf, providers.tf, .terraform.lock.hcl

 - terraform.lock.hcl file should be check in bcs this is a list of Proivders that I have installed locally with specific version

## Install Terraform 

Docs to install Terraform (https://developer.hashicorp.com/terraform/downloads)

For Mac : 

```
brew tap hashicorp/tap
brew install hashicorp/tap/terraform
```

## Basic Terraform Structure 

<img width="600" alt="Screenshot 2025-04-23 at 11 58 49" src="https://github.com/user-attachments/assets/ba769f7c-88c7-4326-905c-4e8380194540" />

#### Configure Terraform AWS Proivder 

In `providers.tf`

```
terraform {
  required_providers {
    aws = {
      source = "hashicorp/aws"
      version = "5.95.0"
    }
  }
}

provider "aws" { 
  region = "us-west-1"
}
```

I can add as many as Provider I needed 

Provider need my AWS Credentials in order to connect to AWS . I could have put my credentials in `prodiver "aws"` but I don't need to . Terraform will go into my ENV `~/.aws` And will take my Credetials from there . For security best practice never expose Credentials on the file 


## Automate AWS Infrastructure

#### Overview 

I will Deploy EC2 Instances on AWS and I will run a simple Docker Container on it 

However before I create that Instance I will Provision AWS Infrastructure for it

To Provision AWS Infrastructure :

 - I need create custom VPC

 - Inside VPC I will create Subnet in one of AZs, I can create multiple Subnet in each AZ

 - Connect this VPC to Internet using Internet Gateway on AWS . Allow traffic to and from VPC with Internet

 - And then In this VPC I will deploy an EC2 Instance

 - Deploy Nginx Docker container

 - Create SG (Firewall) in order to access the nginx server running on the EC2

 - Also I want to SSH to my Server. Open port for that SSH as well

**Terraform Best Pratice**: That I want to create the whole Infrastructure from sratch, I want to deploy everything that I need. And when I don't need it anymore later I can just remove it by using `terraform destroy` without touching the defaults created by AWS . 

#### VPC and Subnet 

To create VPC and Subnet in AWS I need `resources "aws_vpc"` and  `resources "aws_subnet"`

To create VPC, I need to define `cidr_block` like this : 

```
resource "aws_vpc" "main" {
  cidr_block = "10.0.0.0/16"

  tag = {
    Name: "any-name"
  }
}
```

I can extract value to `variables.tf` file and give value to it in `terraform.tfvars` .

```
main.tf

resource "aws_vpc" "my-vpc" {
  cidr_block = var.cidr_block

  tags = {
    Name: "${var.env_prefix}-vpc"
  }
}

----

variables.tf

variable "cidr_block" {}
variable "env_prefix" {}

----

terraform.tfvars

cidr_block = "10.0.0.0/16"
env_prefix = "dev"
```

To create Subnet I will define like this :

 - To get VPC ID `aws_vpc.<vpc-name>.id`

```
main.tf

resource "aws_subnet" "main" {
  vpc_id     = aws_vpc.my-vpc.id # 
  cidr_block = var.subnet_cidr_block
  availability_zone = var.availability_zone

  tags = {
    Name = "${var.env_prefix}-subnet"
  }
}

---

variables.tf

variable "subnet_cidr_block" {}
variable "availability_zone" {}

---

terraform.tfvars

subnet_cidr_block = "10.0.10.0/24"
availability_zone = "us-west-1a"
```

After I have configured VPC and Subnet I can use `terraform apply --auto-approve` to provision it 

#### Route Table And Internet Gateway

**Route table** was generated by AWS for my newly VPC .  

Route table is Virtual Router in VPC . Route Table is just a set of rules that tell my Network where to send traffic 

 - Route table decide where to send network to within a VPC

 - When I click into Route Table in AWS UI . I see `Target : Local` and `Destination: 10.0.0.0/16` mean only route traffic inside my VPC with a range `10.0.0.0/16` .

 - !!! Important NOTE : Route table doesn't care about specific IP address like `10.0.1.15`. It work with CIDR Block, it based on where the destination IP falls, it decides which target (Gateway, endppint, NAT, etc..) to use

**Internet Gateway Target**: This mean this Route Table acutally handles or will handle all the traffic coming from the Internet and leaving the Internet

 - Basically I need the Internet Gateway Target in my Custom VPC so I can connect my VPC to the Internet

#### Create new Route Table














